



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.3, mkdocs-material-2.7.0">
    
    
      
        <title>Futures - Vapor Docs</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/application.78aab2dc.css">
      
        <link rel="stylesheet" href="../../assets/stylesheets/application-palette.6079476c.css">
      
    
    
      <script src="../../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="blue" data-md-color-accent="purple">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448"
    viewBox="0 0 416 448" id="github">
  <path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19-18.125
        8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19 18.125-8.5
        18.125 8.5 10.75 19 3.125 20.5zM320 304q0 10-3.125 20.5t-10.75
        19-18.125 8.5-18.125-8.5-10.75-19-3.125-20.5 3.125-20.5 10.75-19
        18.125-8.5 18.125 8.5 10.75 19 3.125 20.5zM360
        304q0-30-17.25-51t-46.75-21q-10.25 0-48.75 5.25-17.75 2.75-39.25
        2.75t-39.25-2.75q-38-5.25-48.75-5.25-29.5 0-46.75 21t-17.25 51q0 22 8
        38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0
        37.25-1.75t35-7.375 30.5-15 20.25-25.75 8-38.375zM416 260q0 51.75-15.25
        82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5-41.75
        1.125q-19.5 0-35.5-0.75t-36.875-3.125-38.125-7.5-34.25-12.875-30.25-20.25-21.5-28.75q-15.5-30.75-15.5-82.75
        0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25
        30.875q36.75-8.75 77.25-8.75 37 0 70 8 26.25-20.5
        46.75-30.25t47.25-9.75q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34
        99.5z" />
</svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="drawer">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="search">
    <label class="md-overlay" data-md-component="overlay" for="drawer"></label>
    
      <a href="#futures" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../.." title="Vapor Docs" class="md-header-nav__button md-logo">
          
            <img src="../../images/droplet-white.svg" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Vapor Docs
              </span>
              <span class="md-header-nav__topic">
                Futures
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  


  <a href="http://github.com/vapor/vapor/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../../images/droplet-white.svg" width="48" height="48">
      
    </span>
    Vapor Docs
  </label>
  
    <div class="md-nav__source">
      


  


  <a href="http://github.com/vapor/vapor/" title="Go to repository" class="md-source" data-md-source="github">
    
      <div class="md-source__icon">
        <svg viewBox="0 0 24 24" width="24" height="24">
          <use xlink:href="#github" width="24" height="24"></use>
        </svg>
      </div>
    
    <div class="md-source__repository">
      GitHub
    </div>
  </a>

    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="../.." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-2" type="checkbox" id="nav-2">
    
    <label class="md-nav__link" for="nav-2">
      Install
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-2">
        Install
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/macos/" title="macOS" class="md-nav__link">
      macOS
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../install/ubuntu/" title="Ubuntu" class="md-nav__link">
      Ubuntu
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-3" type="checkbox" id="nav-3" checked>
    
    <label class="md-nav__link" for="nav-3">
      Getting started
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-3">
        Getting started
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../hello-world/" title="Hello, world" class="md-nav__link">
      Hello, world
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../toolbox/" title="Toolbox" class="md-nav__link">
      Toolbox
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../spm/" title="SPM" class="md-nav__link">
      SPM
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../xcode/" title="Xcode" class="md-nav__link">
      Xcode
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../structure/" title="Folder Structure" class="md-nav__link">
      Folder Structure
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../application/" title="Application" class="md-nav__link">
      Application
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../controllers/" title="Controllers" class="md-nav__link">
      Controllers
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../routing/" title="Routing" class="md-nav__link">
      Routing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../content/" title="Content" class="md-nav__link">
      Content
    </a>
  </li>

        
          
          
          

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="toc">
        Futures
      </label>
    
    <a href="./" title="Futures" class="md-nav__link md-nav__link--active">
      Futures
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" title="Basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#errors" title="Errors" class="md-nav__link">
    Errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-transformations" title="Basic Transformations" class="md-nav__link">
    Basic Transformations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursive-futures" title="Recursive futures" class="md-nav__link">
    Recursive futures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#always" title="Always" class="md-nav__link">
    Always
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signals" title="Signals" class="md-nav__link">
    Signals
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../services/" title="Services" class="md-nav__link">
      Services
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../cloud/" title="Deployment" class="md-nav__link">
      Deployment
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-4" type="checkbox" id="nav-4">
    
    <label class="md-nav__link" for="nav-4">
      Routing
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-4">
        Routing
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../routing/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../routing/parameters/" title="Parameters" class="md-nav__link">
      Parameters
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../routing/route/" title="Route" class="md-nav__link">
      Route
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../routing/router/" title="Router" class="md-nav__link">
      Router
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-5" type="checkbox" id="nav-5">
    
    <label class="md-nav__link" for="nav-5">
      Fluent
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-5">
        Fluent
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/models/" title="Models" class="md-nav__link">
      Models
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/migrations/" title="Migrations" class="md-nav__link">
      Migrations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/querying/" title="Querying" class="md-nav__link">
      Querying
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/query-builder/" title="Query Builder" class="md-nav__link">
      Query Builder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/schema-builder/" title="Schema Builder" class="md-nav__link">
      Schema Builder
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/relations/" title="Relations" class="md-nav__link">
      Relations
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/pivot/" title="Pivot" class="md-nav__link">
      Pivot
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/transaction/" title="Transaction" class="md-nav__link">
      Transaction
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../fluent/database/" title="Database" class="md-nav__link">
      Database
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-6" type="checkbox" id="nav-6">
    
    <label class="md-nav__link" for="nav-6">
      PostgreSQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-6">
        PostgreSQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../postgresql/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../postgresql/fluent/" title="Fluent PostgreSQL" class="md-nav__link">
      Fluent PostgreSQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../postgresql/core/" title="PostgreSQL Core" class="md-nav__link">
      PostgreSQL Core
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-7" type="checkbox" id="nav-7">
    
    <label class="md-nav__link" for="nav-7">
      MySQL
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-7">
        MySQL
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/fluent/" title="Fluent MySQL" class="md-nav__link">
      Fluent MySQL
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../mysql/core/" title="MySQL Core" class="md-nav__link">
      MySQL Core
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      SQLite
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        SQLite
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlite/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlite/fluent/" title="Fluent SQLite" class="md-nav__link">
      Fluent SQLite
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../sqlite/core/" title="SQLite Core" class="md-nav__link">
      SQLite Core
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      Leaf
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        Leaf
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../leaf/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leaf/basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../leaf/custom-tags/" title="Custom tags" class="md-nav__link">
      Custom tags
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-10" type="checkbox" id="nav-10">
    
    <label class="md-nav__link" for="nav-10">
      Redis
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-10">
        Redis
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/basics/" title="Basics" class="md-nav__link">
      Basics
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/custom-commands/" title="Custom commands" class="md-nav__link">
      Custom commands
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/pub-sub/" title="Publish and Subscribe" class="md-nav__link">
      Publish and Subscribe
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../redis/pipeline/" title="Pipeline" class="md-nav__link">
      Pipeline
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-11" type="checkbox" id="nav-11">
    
    <label class="md-nav__link" for="nav-11">
      WebSocket
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-11">
        WebSocket
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../websocket/websocket/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-12" type="checkbox" id="nav-12">
    
    <label class="md-nav__link" for="nav-12">
      Crypto
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-12">
        Crypto
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/getting-started/" title="Getting Started" class="md-nav__link">
      Getting Started
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/base64/" title="Base64" class="md-nav__link">
      Base64
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/hash/" title="Hashes" class="md-nav__link">
      Hashes
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/mac/" title="Message authentication" class="md-nav__link">
      Message authentication
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/passwords/" title="Password hashing" class="md-nav__link">
      Password hashing
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../crypto/random/" title="Random" class="md-nav__link">
      Random
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-13" type="checkbox" id="nav-13">
    
    <label class="md-nav__link" for="nav-13">
      Version (3.0-rc)
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-13">
        Version (3.0-rc)
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../../version/1_5/" title="1.5" class="md-nav__link">
      1.5
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../version/2_0/" title="2.0" class="md-nav__link">
      2.0
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../version/3_0/" title="3.0-rc" class="md-nav__link">
      3.0-rc
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../../version/support/" title="Support" class="md-nav__link">
      Support
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#basics" title="Basics" class="md-nav__link">
    Basics
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#errors" title="Errors" class="md-nav__link">
    Errors
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#basic-transformations" title="Basic Transformations" class="md-nav__link">
    Basic Transformations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#recursive-futures" title="Recursive futures" class="md-nav__link">
    Recursive futures
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#always" title="Always" class="md-nav__link">
    Always
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#signals" title="Signals" class="md-nav__link">
    Signals
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/vapor/documentation/edit/beta/3.0/docs/getting-started/futures.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="futures">Futures<a class="headerlink" href="#futures" title="Permanent link">&para;</a></h1>
<p>You may have noticed some APIs in Vapor expect or return a <code>Future&lt;T&gt;</code> type.
If this is your first time hearing about futures, they might seem a little confusing at first.
But don't worry, Vapor makes them easy to use.</p>
<p>Promises and Futures are two strongly related types. Every promise has a future.
A promise is a write-only entity that has the ability to complete (or fail) it's Future counterpart.</p>
<p>Futures are a read-only entity that can have a successful or error case. Successful cases are called the "Expectation".</p>
<p>Futures can be used to register callbacks to, which will always executed in the order of registration. Promises can only be completed once. If a promise is completed more than once the input will be <em>ignored</em>.</p>
<h2 id="basics">Basics<a class="headerlink" href="#basics" title="Permanent link">&para;</a></h2>
<p>Creating a promise is when the result is returned in the future at an unknown time.
For the sake of demonstration, however, the promise will be completed at a predefined point in time and execution.</p>
<p>Within the <code>.do</code> block you may not throw an error or return a result.</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">promise</span> <span class="p">=</span> <span class="n">Promise</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">&gt;()</span>
<span class="kd">let</span> <span class="nv">future</span> <span class="p">=</span> <span class="n">promise</span><span class="p">.</span><span class="n">future</span> <span class="c1">// Future&lt;String&gt;</span>

<span class="n">future</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">string</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">promise</span><span class="p">.</span><span class="n">complete</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">)</span>
</pre></div>


<p>The above code prints "Hello" in the console.</p>
<h2 id="errors">Errors<a class="headerlink" href="#errors" title="Permanent link">&para;</a></h2>
<p>When running the above code, you may have noticed a warning pop up. This is because the <code>.do</code> block only handles successful completions. If we were to replace the completion with the following code the <code>.do</code> block would never get run:</p>
<div class="codehilite"><pre><span></span><span class="kd">struct</span> <span class="nc">MyError</span><span class="p">:</span> <span class="n">Error</span> <span class="p">{}</span>

<span class="n">promise</span><span class="p">.</span><span class="n">fail</span><span class="p">(</span><span class="n">MyError</span><span class="p">())</span>
</pre></div>


<p>Instead, a <code>.catch</code> block will be triggered.</p>
<div class="codehilite"><pre><span></span><span class="n">future</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">string</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>


<p>In this scenario the test "Error 'MyError' occurred" will appear.</p>
<p>Within the <code>.catch</code> block you may not throw an error or return a result.</p>
<h2 id="basic-transformations">Basic Transformations<a class="headerlink" href="#basic-transformations" title="Permanent link">&para;</a></h2>
<p>Transformations are one of the more critical parts of Vapor 3's future system. They assist in reducing the complexity of futures and keep code isolated and readable. You can use the <code>.map</code> function to transform the future expectation to another future of the same or a different type. You need to explicitly state which type will be returned in the mapping closure.</p>
<p>The mapping closure(s) will <em>only</em> be executed if an expectation has been received in the previous step. If at any point a transformation function throws an error, execution stops there and the <code>.catch</code> block will be executed.</p>
<p>If the promise that was mapped failed to begin with, the <code>.catch</code> block will also be executed <em>without</em> triggering <em>any</em> mapping closures.</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">promise</span> <span class="p">=</span> <span class="n">Promise</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;()</span>

<span class="n">promise</span><span class="p">.</span><span class="n">future</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">int</span><span class="p">)</span>
<span class="p">}.</span><span class="bp">map</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nb">Int</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">int</span> <span class="o">+</span> <span class="mi">4</span>
<span class="p">}.</span><span class="bp">map</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">int</span><span class="p">.</span><span class="n">description</span>
<span class="p">}.</span><span class="k">do</span> <span class="p">{</span> <span class="n">string</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">promise</span><span class="p">.</span><span class="n">complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>


<p>The above code will print the inputted integer. Then map the input to <code>(integer + 4) == 7</code>.
Then the textual representation of the integer is returned as a <code>String</code> which will be printed.</p>
<p>This results in the following console output:</p>
<div class="codehilite"><pre><span></span><span class="m">3</span>
<span class="m">7</span>
</pre></div>


<h2 id="recursive-futures">Recursive futures<a class="headerlink" href="#recursive-futures" title="Permanent link">&para;</a></h2>
<p>In the above <code>map</code> function we returned a new result synchronously. In some situations, however, you'll need to dispatch another asynchronous call based on the result of a previous call.</p>
<p>First, let's see how this would work out using <code>map</code> by exaggerating synchronous code as if it were an asynchronous call.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do not use this implementation, use the next one instead. This is an unnecessarily complicated way of nesting futures.</p>
</div>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">promise</span> <span class="p">=</span> <span class="n">Promise</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;()</span>

<span class="n">promise</span><span class="p">.</span><span class="bp">map</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Future</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">Future</span><span class="p">(</span><span class="n">int</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">}.</span><span class="bp">map</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Future</span><span class="p">&lt;</span><span class="n">Future</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">&gt;</span><span class="o">&gt;</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">futureInt</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">futureInt</span><span class="p">.</span><span class="bp">map</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="n">Future</span><span class="p">&lt;</span><span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">&gt;)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
        <span class="k">return</span> <span class="n">Future</span><span class="p">(</span><span class="n">int</span><span class="p">.</span><span class="n">description</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="k">do</span> <span class="p">{</span> <span class="n">doubleFutureString</span> <span class="k">in</span> <span class="c1">// Future&lt;Future&lt;String&gt;&gt;</span>
    <span class="n">doubleFutureString</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">futureString</span> <span class="k">in</span> <span class="c1">// Future&lt;String&gt;</span>
      <span class="n">futureString</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">string</span> <span class="k">in</span>
          <span class="bp">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
      <span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
          <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
      <span class="p">}</span>
    <span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
        <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">promise</span><span class="p">.</span><span class="n">complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>


<p>To flatten this asynchronous recursion, instead, we recommend using <code>flatMap</code>.
The type supplied in the <code>to:</code> argument is implied to be wrapped in a <code>Future&lt;&gt;</code>.</p>
<div class="codehilite"><pre><span></span><span class="kd">let</span> <span class="nv">promise</span> <span class="p">=</span> <span class="n">Promise</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;()</span>

<span class="n">promise</span><span class="p">.</span><span class="n">flatMap</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nb">Int</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">Future</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;(</span><span class="n">int</span> <span class="o">+</span> <span class="mi">4</span><span class="p">)</span>
<span class="p">}.</span><span class="n">flatMap</span><span class="p">(</span><span class="n">to</span><span class="p">:</span> <span class="nb">String</span><span class="p">.</span><span class="kc">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="k">return</span> <span class="n">Future</span><span class="p">(</span><span class="n">int</span><span class="p">.</span><span class="n">description</span><span class="p">)</span>
<span class="p">}.</span><span class="k">do</span> <span class="p">{</span> <span class="n">string</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
<span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="n">error</span> <span class="k">in</span>
    <span class="bp">print</span><span class="p">(</span><span class="s">&quot;Error &#39;</span><span class="si">\(</span><span class="n">error</span><span class="si">)</span><span class="s">&#39; occurred&quot;</span><span class="p">)</span>
<span class="p">}</span>

<span class="n">promise</span><span class="p">.</span><span class="n">complete</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>


<h2 id="always">Always<a class="headerlink" href="#always" title="Permanent link">&para;</a></h2>
<p>Sometimes you want to always execute a function as part of the cleanup phase.
You can use the <code>.always</code> block to execute a block of code after the future has been successfully executed (and mapped if applicable) or when an error occurs. Please do consider that <code>always</code> also will be executed in the order in which it has been registered, like all other closures.</p>
<div class="codehilite"><pre><span></span><span class="kd">var</span> <span class="nv">i</span> <span class="p">=</span> <span class="mi">0</span>

<span class="kd">let</span> <span class="nv">promise</span> <span class="p">=</span> <span class="n">Promise</span><span class="p">&lt;</span><span class="nb">Int</span><span class="p">&gt;()</span>
<span class="kd">let</span> <span class="nv">future</span> <span class="p">=</span> <span class="n">promise</span><span class="p">.</span><span class="n">future</span> <span class="c1">// Future&lt;Int&gt;</span>

<span class="n">future</span><span class="p">.</span><span class="k">do</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="n">int</span> <span class="o">*</span> <span class="mi">3</span>
<span class="p">}.</span><span class="k">do</span> <span class="p">{</span> <span class="n">int</span> <span class="k">in</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="p">(</span><span class="n">int</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">}.</span><span class="n">always</span> <span class="p">{</span>
    <span class="bp">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="n">i</span> <span class="p">=</span> <span class="mi">0</span>
<span class="p">}.</span><span class="k">catch</span> <span class="p">{</span> <span class="kc">_</span> <span class="k">in</span>
    <span class="n">i</span> <span class="p">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="p">}</span>
</pre></div>


<p>At the end of the above function, <code>i</code> will <em>always</em> be 0. If the promise is completed with the successful result <code>i</code>, the number "11" will be printed. On error, "-1" will be printed.</p>
<h2 id="signals">Signals<a class="headerlink" href="#signals" title="Permanent link">&para;</a></h2>
<p>Signals, or <code>Future&lt;Void&gt;</code> is a Future that can contain either an Error or Void (the Expectation). <code>Future&lt;Void&gt;</code> is often used to indicate the successful or unsuccessful completion of a task.</p>
                
                  
                
              
              
                
              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../content/" title="Content" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Content
              </span>
            </div>
          </a>
        
        
          <a href="../services/" title="Services" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Services
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2018 Qutheory, LLC
          </div>
        
        powered by
        <a href="http://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
        
  <div class="md-footer-social">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
      <a href="https://twitter.com/@codevapor" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="http://vapor.team/" class="md-footer-social__link fa fa-slack"></a>
    
      <a href="https://github.com/vapor" class="md-footer-social__link fa fa-github"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../../assets/javascripts/application.8eb9be28.js"></script>
      
      <script>app.initialize({version:"0.17.3",url:{base:"../.."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","UA-76177358-4","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>